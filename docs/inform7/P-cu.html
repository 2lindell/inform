<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Booklet Title</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">
		<link href="inweb.css" rel="stylesheet" rev="stylesheet" type="text/css">
	</head>
	<body>

<!--Weave of 'P/cu' generated by 7-->
<ul class="crumbs"><li><a href="../webs.html">&#9733;</a></li><li><a href="index.html">inform7 7.10.1</a></li><li><a href="index.html#P">Preliminaries</a></li><li><b>Command-Line Usage</b></li></ul><p class="purpose">A brief note on using Inform 7 at the command line.</p>

<ul class="toc"><li><a href="#SP1">&#167;1. Disclaimer</a></li><li><a href="#SP2">&#167;2. Basic usage</a></li><li><a href="#SP7">&#167;7. Experimental Inter features</a></li><li><a href="#SP8">&#167;8. Testing and debugging switches</a></li><li><a href="#SP9">&#167;9. Prehistory</a></li></ul><hr class="tocbar">

<p class="inwebparagraph"><a id="SP1"></a><b>&#167;1. Disclaimer. </b>This is not documentation on the Inform language or its user-interface apps:
it's a technical note on how the command-line tool inside those apps is called.
</p>

<p class="inwebparagraph">The <code class="display"><span class="extract">inform7</span></code> executable has a few ancillary functions, but basically it
takes natural language source text and compiles it to either "inter", an
intermediate-level code, or all the way to Inform 6 source code. In order
to run, it needs access to numerous resources, and many of its command-line
switches exist to specify where those are to be found.
</p>

<p class="inwebparagraph">If you are using Inform 7 at the command line, the executable should be
stored at <code class="display"><span class="extract">inform/inform7/Tangled/inform7</span></code>. In these notes we will assume
the current working directory is <code class="display"><span class="extract">inform</span></code>. To test that it has been built,
try:
</p>

<p class="inwebparagraph"></p>


<pre class="display">
        <span class="plain">inform7/Tangled/inform7 -help</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP2"></a><b>&#167;2. Basic usage. </b>The full range of options is complex, so it seems helpful to start by showing
what the Inform UI apps typically call when the user clicks "Go":
</p>

<p class="inwebparagraph"></p>


<pre class="display">
        <span class="plain">inform7/Tangled/inform7 -internal I -external E -project P -format=F</span>
</pre>

<p class="inwebparagraph">for suitable pathnames <code class="display"><span class="extract">I</span></code>, <code class="display"><span class="extract">E</span></code>, <code class="display"><span class="extract">P</span></code> and a choice of <code class="display"><span class="extract">F</span></code>. To dispose of this
first, <code class="display"><span class="extract">-format=ulx</span></code> tells Inform to compile to the Glulx story file, and
<code class="display"><span class="extract">-format=z8</span></code> to (version 8 of) the Z-machine.
</p>

<p class="inwebparagraph">The project <code class="display"><span class="extract">P</span></code> is the directory holding the project to compile, such as
<code class="display"><span class="extract">Bronze.inform</span></code>. On MacOS, this will be a bundle, and will look like an
opaque binary file in the Finder, but it is a directory nevertheless.
</p>

<p class="inwebparagraph">The directories <code class="display"><span class="extract">I</span></code> and <code class="display"><span class="extract">E</span></code> tell Inform where to find its resources. Internal
means "inside the app" &mdash; in other words, fixed material supplied with Inform
and always present; external means "outside the app", and is where the user
installs her own choice of extra resources.
</p>

<p class="inwebparagraph"><a id="SP3"></a><b>&#167;3.  </b>If no <code class="display"><span class="extract">-external E</span></code> is given, Inform behaves as it would in a clean
installation with no external resources available.
</p>

<p class="inwebparagraph">If no <code class="display"><span class="extract">-internal I</span></code> is given on the command line, Inform 7 tries to find
out where it is installed in the file system. There is no completely foolproof,
cross-platform way to know this (on some Unixes, a program cannot determine
its own location), so Inform decides by the following set of rules:
</p>

<p class="inwebparagraph"></p>

<ul class="items"><li>(a) If the user, at the command line, specified <code class="display"><span class="extract">-at P</span></code>, for some path
<code class="display"><span class="extract">P</span></code>, then we use that.
</li><li>(b) Otherwise, if the host operating system can indeed tell us where the
executable is, we use that. This is currently implemented only on MacOS,
Windows and Linux.
</li><li>(c) Otherwise, if the environment variable <code class="display"><span class="extract">$INFORM7_PATH</span></code> exists and is
non-empty, we use that.
</li><li>(d) And if all else fails, we assume that the location is <code class="display"><span class="extract">inform7</span></code>, with
respect to the current working directory.
</li></ul>
<p class="inwebparagraph">The default value for <code class="display"><span class="extract">-internal</span></code> is then the subdirectory <code class="display"><span class="extract">Internal</span></code> of
this location: for example, <code class="display"><span class="extract">inform7/Internal</span></code>.
</p>

<p class="inwebparagraph"><a id="SP4"></a><b>&#167;4.  </b>If the user of an Inform UI app clicks Release instead of Go, the
command-line switch <code class="display"><span class="extract">-release</span></code> is added to the above command. See the main
Inform documentation for what this does.
</p>

<p class="inwebparagraph">On some UI apps, there's a menu item "Release for testing...": this should
add <code class="display"><span class="extract">-debug</span></code> to <code class="display"><span class="extract">-release</span></code>, which causes Inform to include debugging commands
in the story file it generates. (Those commands are ordinarily suppressed
by <code class="display"><span class="extract">-release</span></code> to prevent story files accidentally being shipped with them
still in place.)
</p>

<p class="inwebparagraph">Similarly, the Settings pane in the app contains a checkbox for "Make
random outcomes predictable when testing": the app achieves this by adding
the switch <code class="display"><span class="extract">-rng</span></code> to the above command-line call.
</p>

<p class="inwebparagraph"><a id="SP5"></a><b>&#167;5.  </b>If the app has a feature for systematically testing each example in an
extension project, then it should add the switch <code class="display"><span class="extract">-case A</span></code> when running
example A through inform7, <code class="display"><span class="extract">-case B</span></code> for B, and so on. This ensures that
if the compiler generates Problem messages (i,e., if those tests fail
to compile) then source-reference links will be to the right examples.
</p>

<p class="inwebparagraph">For ordinary, non-Extension, projects, this switch should not be used.
</p>

<p class="inwebparagraph"><a id="SP6"></a><b>&#167;6.  </b>When the app installs a new extension (in the external area), or is run
for the first time, it should call Inform 7 to perform a "census" of the
available extensions. The compiler then looks through its internal and
external areas, and creates suitable HTML pages showing what it finds,
which it stores in a writeable area of the file system called the "transient"
directory.
</p>

<p class="inwebparagraph">The usage for this is:
</p>

<p class="inwebparagraph"></p>


<pre class="display">
        <span class="plain">inform7/Tangled/inform7 -internal I -external E -transient T -census</span>
</pre>

<p class="inwebparagraph">(The caller has the obligation to provide the Transient directory.)
</p>

<p class="inwebparagraph"><a id="SP7"></a><b>&#167;7. Experimental Inter features. </b>The options <code class="display"><span class="extract">-export X</span></code>, <code class="display"><span class="extract">-import X</span></code> and <code class="display"><span class="extract">-inter X</span></code> are not final, likely
to change, and not documented.
</p>

<p class="inwebparagraph"><a id="SP8"></a><b>&#167;8. Testing and debugging switches. </b>The following switches are used only when testing or maintaining Inform,
and are unlikely to be useful to end users. Many of these are, however,
used in the Intest scripts for testing Inform 7 and Inblorb.
</p>

<p class="inwebparagraph"></p>

<ul class="items"><li>(a) <code class="display"><span class="extract">-clock</span></code> times the run.
</li><li>(b) <code class="display"><span class="extract">-crash-all</span></code> performs a deliberate hard crash, dividing by zero, in
the event of any Problem message being issues &mdash; this makes it easier to
obtain stack backtraces in a debugger.
</li><li>(c) <code class="display"><span class="extract">-no-index</span></code> skips the production of an Index, which reduces file system
writes in a big testing run, and also saves a little time.
</li><li>(d) <code class="display"><span class="extract">-no-progress</span></code> suppresses console output of the "++ 26% (Binding rulebooks)"
kind.
</li><li>(e) <code class="display"><span class="extract">-sigils</span></code> causes each Problem message to be preceded in console output
by its "sigil", that is, its internal code. A typical sigil is
<code class="display"><span class="extract">PM_PropertyNameTooLong</span></code>, where the ubiquitous PM stands for "property
message".
</li><li>(f) <code class="display"><span class="extract">-require-problem SIGIL</span></code> tells Inform to return an exit code of 0 if
exactly this problem message is produced, and 1 otherwise.
</li></ul>
<p class="inwebparagraph"><a id="SP9"></a><b>&#167;9. Prehistory. </b>Build 1A01 was the first rough draft of a completed compiler: but it did
not synchronise fully with the OS X Inform application until 1G22 and
private beta-testing did not begin until 1J34. Other milestones include
time (1B92), tables (1C86), component parts (1E60), indexing (1F46),
systematic memory allocation (1J53), pattern matching (1M11), the map index
(1P97), extension documentation support (1S39) and activities (1T89). The
first round of testing, a heroic effort by Emily Short and Sonja Kesserich,
came informally to an end at around the 1V50 build, after which a general
rewriting exercise began. Minor changes needed for David Kinder's Windows
port began to be made with 1W80, but the main aims were to increase speed
and to improve clarity of source code. Hashing algorithms adapted to
word-based syntax were introduced in 1Z50; the prototype parser was then
comprehensively rewritten using a unified system to handle ambiguities and
avoid blind alleys. A time trial of 2D52 against 1V59 on the same, very
large, source text showed a speed increase of a factor of four. A second
stage of rewriting, to generalise binary predicates and improve grammatical
accuracy, began with 2D70. By the time of the first public beta release,
3K27, the testing tool <code class="display"><span class="extract">inform-test</span></code> had been written (it subsequently
evolved into today's <code class="display"><span class="extract">intest</span></code>), and Emily Short's extensive suite of Examples
had been worked into the verification process for builds. The history since
3K27 is recorded in the published change log.
</p>

<hr class="tocbar">
<ul class="toc"><li><i>(This section begins Preliminaries.)</i></li><li><i>(This section ends Preliminaries.)</i></li></ul><hr class="tocbar">
<!--End of weave-->
	</body>
</html>

