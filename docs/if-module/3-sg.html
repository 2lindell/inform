<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Spatial Geometry</title>
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">
		<link href="../inweb.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body>
		<nav role="navigation">
		<h1><a href="../index.html">
<img src="../docs-src/Figures/Inform.png" height=72">
</a></h1>
<ul><li><a href="../compiler.html">compiler tools</a></li>
<li><a href="../other.html">other tools</a></li>
<li><a href="../extensions.html">extensions and kits</a></li>
<li><a href="../units.html">unit test tools</a></li>
</ul><h2>Compiler Webs</h2><ul>
<li><a href="../inbuild/index.html">inbuild</a></li>
<li><a href="../inform7/index.html">inform7</a></li>
<li><a href="../inter/index.html">inter</a></li>
</ul><h2>Inbuild Modules</h2><ul>
<li><a href="../supervisor-module/index.html">supervisor</a></li>
</ul><h2>Inform7 Modules</h2><ul>
<li><a href="../core-module/index.html">core</a></li>
<li><a href="../inflections-module/index.html">inflections</a></li>
<li><a href="../linguistics-module/index.html">linguistics</a></li>
<li><a href="../kinds-module/index.html">kinds</a></li>
<li><a href="index.html"><span class="selectedlink">if</span></a></li>
<li><a href="../multimedia-module/index.html">multimedia</a></li>
<li><a href="../problems-module/index.html">problems</a></li>
<li><a href="../index-module/index.html">index</a></li>
</ul><h2>Inter Modules</h2><ul>
<li><a href="../bytecode-module/index.html">bytecode</a></li>
<li><a href="../building-module/index.html">building</a></li>
<li><a href="../codegen-module/index.html">codegen</a></li>
</ul><h2>Shared Modules</h2><ul>
<li><a href="../arch-module/index.html">arch</a></li>
<li><a href="../syntax-module/index.html">syntax</a></li>
<li><a href="../words-module/index.html">words</a></li>
<li><a href="../html-module/index.html">html</a></li>
<li><a href="../../../inweb/docs/foundation-module/index.html">foundation</a></li>

</ul>
		</nav>
		<main role="main">
		
<!--Weave of 'Spatial Geometry' generated by 7-->
<ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="../compiler.html">Inform7 Modules</a></li><li><a href="index.html">if</a></li><li><a href="index.html#3">Chapter 3: Space and Time</a></li><li><b>Spatial Geometry</b></li></ul><p class="purpose">To deal with vectors and cuboids in a three-dimensional integer lattice.</p>

<ul class="toc"><li><a href="#SP1">&#167;1. Definitions</a></li><li><a href="#SP5">&#167;5. Vectors</a></li><li><a href="#SP8">&#167;8. Lengths</a></li><li><a href="#SP9">&#167;9. Angles</a></li><li><a href="#SP10">&#167;10. Cuboids</a></li></ul><hr class="tocbar">

<p class="inwebparagraph"><a id="SP1"></a><b>&#167;1. Definitions. </b></p>

<p class="inwebparagraph"><a id="SP2"></a><b>&#167;2.  </b>We will store 3-vectors in the obvious way:
</p>

<pre class="display">
    <span class="reserved">typedef</span><span class="plain"> </span><span class="reserved">struct</span><span class="plain"> </span><span class="reserved">vector</span><span class="plain"> {</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">x</span><span class="plain">, </span><span class="identifier">y</span><span class="plain">, </span><span class="identifier">z</span><span class="plain">;</span>
    <span class="plain">} </span><span class="reserved">vector</span><span class="plain">;</span>
</pre>

<p class="inwebparagraph"></p>

<p class="endnote">The structure vector is accessed in 3/sm2, 3/hm, 3/em and here.</p>

<p class="inwebparagraph"><a id="SP3"></a><b>&#167;3.  </b>Some useful constant vectors, including those pointing in each direction.
Note that these are not of unit length &mdash; rather, they are the ideal grid
offsets on the map we will eventually draw.
</p>

<pre class="display">
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">Zero_vector</span><span class="plain"> = {0, </span><span class="constant">0</span><span class="plain">, </span><span class="constant">0</span><span class="plain">};</span>

    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">N_vector</span><span class="plain"> = {0, </span><span class="constant">1</span><span class="plain">, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">NE_vector</span><span class="plain"> = {1, </span><span class="constant">1</span><span class="plain">, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">NW_vector</span><span class="plain"> = {-1, </span><span class="constant">1</span><span class="plain">, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">S_vector</span><span class="plain"> = {0, -1, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">SE_vector</span><span class="plain"> = {1, -1, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">SW_vector</span><span class="plain"> = {-1, -1, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">E_vector</span><span class="plain"> = {1, </span><span class="constant">0</span><span class="plain">, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">W_vector</span><span class="plain"> = {-1, </span><span class="constant">0</span><span class="plain">, </span><span class="constant">0</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">U_vector</span><span class="plain"> = {0, </span><span class="constant">0</span><span class="plain">, </span><span class="constant">1</span><span class="plain">};</span>
    <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">D_vector</span><span class="plain"> = {0, </span><span class="constant">0</span><span class="plain">, -1};</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP4"></a><b>&#167;4.  </b>A cuboid is a volume of space with opposing corners at integer grid
positions which form a tightest-possible bounding box around a finite
number of points (of size <code class="display"><span class="extract">population</span></code>); when this is 0, of course, the
corners are meaningless and are by convention at the origin.
</p>

<pre class="display">
    <span class="reserved">typedef</span><span class="plain"> </span><span class="reserved">struct</span><span class="plain"> </span><span class="reserved">cuboid</span><span class="plain"> {</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">population</span><span class="plain">;</span>
        <span class="reserved">struct</span><span class="plain"> </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">corner0</span><span class="plain">;</span>
        <span class="reserved">struct</span><span class="plain"> </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">corner1</span><span class="plain">;</span>
    <span class="plain">} </span><span class="reserved">cuboid</span><span class="plain">;</span>
</pre>

<p class="inwebparagraph"></p>

<p class="endnote">The structure cuboid is accessed in 3/sm2, 3/hm, 3/em and here.</p>

<p class="inwebparagraph"><a id="SP5"></a><b>&#167;5. Vectors. </b></p>

<pre class="display">
    <span class="reserved">vector</span><span class="plain"> </span><span class="functiontext">Geometry::vec<button class="popup" onclick="togglePopup('usagePopup178')">...<span class="popuptext" id="usagePopup178">Usage of <b>Geometry::vec</b>:<br>Spatial Map - <a href="3-sm2.html#SP16_1">&#167;16.1</a>, <a href="3-sm2.html#SP8_31">&#167;8.31</a>, <a href="3-sm2.html#SP8_32_1_1">&#167;8.32.1.1</a>, <a href="3-sm2.html#SP8_32_1_2">&#167;8.32.1.2</a>, <a href="3-sm2.html#SP8_32_1_3">&#167;8.32.1.3</a><br>HTML Map - <a href="3-hm.html#SP9">&#167;9</a>, <a href="3-hm.html#SP9_3_1_1">&#167;9.3.1.1</a>, <a href="3-hm.html#SP9_3_2_1">&#167;9.3.2.1</a>, <a href="3-hm.html#SP9_3_3_1">&#167;9.3.3.1</a></span></button></span><span class="plain">(</span><span class="reserved">int</span><span class="plain"> </span><span class="identifier">x</span><span class="plain">, </span><span class="reserved">int</span><span class="plain"> </span><span class="identifier">y</span><span class="plain">, </span><span class="reserved">int</span><span class="plain"> </span><span class="identifier">z</span><span class="plain">) {</span>
        <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
        <span class="identifier">R</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">x</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">y</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">z</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP6"></a><b>&#167;6.  </b>A vector is "lateral" if lies in the \(x\)-\(y\) plane.
</p>

<pre class="display">
    <span class="reserved">int</span><span class="plain"> </span><span class="functiontext">Geometry::vec_eq<button class="popup" onclick="togglePopup('usagePopup179')">...<span class="popuptext" id="usagePopup179">Usage of <b>Geometry::vec_eq</b>:<br>Spatial Map - <a href="3-sm2.html#SP8_11">&#167;8.11</a>, <a href="3-sm2.html#SP21">&#167;21</a>, <a href="3-sm2.html#SP22">&#167;22</a>, <a href="3-sm2.html#SP33">&#167;33</a><br>HTML Map - <a href="3-hm.html#SP1_3_4">&#167;1.3.4</a>, <a href="3-hm.html#SP1_3_4_1">&#167;1.3.4.1</a>, <a href="3-hm.html#SP1_3_4_2">&#167;1.3.4.2</a>, <a href="3-hm.html#SP2_1">&#167;2.1</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">U</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> ((</span><span class="identifier">U</span><span class="plain">.</span><span class="element">x</span><span class="plain"> == </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">) &amp;&amp; (</span><span class="identifier">U</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> == </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) &amp;&amp; (</span><span class="identifier">U</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> == </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">)) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">TRUE</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">int</span><span class="plain"> </span><span class="functiontext">Geometry::vec_lateral<button class="popup" onclick="togglePopup('usagePopup180')">...<span class="popuptext" id="usagePopup180">Usage of <b>Geometry::vec_lateral</b>:<br>Spatial Map - <a href="3-sm2.html#SP8_10">&#167;8.10</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> ((</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> == </span><span class="constant">0</span><span class="plain">) &amp;&amp; (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> == </span><span class="constant">0</span><span class="plain">)) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">TRUE</span><span class="plain">;</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP7"></a><b>&#167;7.  </b>The vector space operations:
</p>

<pre class="display">
    <span class="reserved">vector</span><span class="plain"> </span><span class="functiontext">Geometry::vec_plus<button class="popup" onclick="togglePopup('usagePopup181')">...<span class="popuptext" id="usagePopup181">Usage of <b>Geometry::vec_plus</b>:<br><a href="#SP12">&#167;12</a>, <a href="#SP15">&#167;15</a>, Spatial Map - <a href="3-sm2.html#SP8_21">&#167;8.21</a>, <a href="3-sm2.html#SP8_26">&#167;8.26</a>, <a href="3-sm2.html#SP8_27">&#167;8.27</a>, <a href="3-sm2.html#SP21">&#167;21</a>, <a href="3-sm2.html#SP23_1_4_1">&#167;23.1.4.1</a>, <a href="3-sm2.html#SP33">&#167;33</a>, <a href="3-sm2.html#SP37_1">&#167;37.1</a>, <a href="3-sm2.html#SP8_31">&#167;8.31</a>, <a href="3-sm2.html#SP8_32_1_2">&#167;8.32.1.2</a>, <a href="3-sm2.html#SP8_32_1_3">&#167;8.32.1.3</a><br>HTML Map - <a href="3-hm.html#SP1_3_4_2">&#167;1.3.4.2</a>, <a href="3-hm.html#SP2">&#167;2</a>, <a href="3-hm.html#SP2_1">&#167;2.1</a>, <a href="3-hm.html#SP3">&#167;3</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">U</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
        <span class="identifier">R</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">U</span><span class="plain">.</span><span class="element">x</span><span class="plain"> + </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">U</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> + </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">U</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> + </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">vector</span><span class="plain"> </span><span class="functiontext">Geometry::vec_minus<button class="popup" onclick="togglePopup('usagePopup182')">...<span class="popuptext" id="usagePopup182">Usage of <b>Geometry::vec_minus</b>:<br><a href="#SP14">&#167;14</a>, <a href="#SP15">&#167;15</a>, Spatial Map - <a href="3-sm2.html#SP21">&#167;21</a>, <a href="3-sm2.html#SP22">&#167;22</a>, <a href="3-sm2.html#SP23_1_4_1">&#167;23.1.4.1</a>, <a href="3-sm2.html#SP35_1">&#167;35.1</a>, <a href="3-sm2.html#SP8_32_1_2">&#167;8.32.1.2</a>, <a href="3-sm2.html#SP8_32_1_3">&#167;8.32.1.3</a>, <a href="3-sm2.html#SP8_33">&#167;8.33</a><br>HTML Map - <a href="3-hm.html#SP1_3_4_1">&#167;1.3.4.1</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">U</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
        <span class="identifier">R</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">U</span><span class="plain">.</span><span class="element">x</span><span class="plain"> - </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">U</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> - </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">U</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> - </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">vector</span><span class="plain"> </span><span class="functiontext">Geometry::vec_negate<button class="popup" onclick="togglePopup('usagePopup183')">...<span class="popuptext" id="usagePopup183">Usage of <b>Geometry::vec_negate</b>:<br>Spatial Map - <a href="3-sm2.html#SP8_32_1_3_1">&#167;8.32.1.3.1</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
        <span class="identifier">R</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = -</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = -</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = -</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">vector</span><span class="plain"> </span><span class="functiontext">Geometry::vec_scale<button class="popup" onclick="togglePopup('usagePopup184')">...<span class="popuptext" id="usagePopup184">Usage of <b>Geometry::vec_scale</b>:<br>Spatial Map - <a href="3-sm2.html#SP23_1_4_1">&#167;23.1.4.1</a>, <a href="3-sm2.html#SP33">&#167;33</a>, <a href="3-sm2.html#SP37_1">&#167;37.1</a><br>HTML Map - <a href="3-hm.html#SP1_3_4_1">&#167;1.3.4.1</a></span></button></span><span class="plain">(</span><span class="reserved">int</span><span class="plain"> </span><span class="identifier">lambda</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
        <span class="identifier">R</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">lambda</span><span class="plain">*</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">lambda</span><span class="plain">*</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">; </span><span class="identifier">R</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">lambda</span><span class="plain">*</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">R</span><span class="plain">;</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP8"></a><b>&#167;8. Lengths. </b></p>

<pre class="display">
    <span class="reserved">int</span><span class="plain"> </span><span class="functiontext">Geometry::vec_length_squared<button class="popup" onclick="togglePopup('usagePopup185')">...<span class="popuptext" id="usagePopup185">Usage of <b>Geometry::vec_length_squared</b>:<br>Spatial Map - <a href="3-sm2.html#SP21">&#167;21</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">*</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> + </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">*</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> + </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">*</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">float</span><span class="plain"> </span><span class="functiontext">Geometry::vec_length<button class="popup" onclick="togglePopup('usagePopup186')">...<span class="popuptext" id="usagePopup186">Usage of <b>Geometry::vec_length</b>:<br><a href="#SP9">&#167;9</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">return</span><span class="plain"> (</span><span class="reserved">float</span><span class="plain">) (</span><span class="identifier">sqrt</span><span class="plain">(</span><span class="functiontext"><a href="#SP8">Geometry::vec_length_squared</a></span><span class="plain">(</span><span class="identifier">V</span><span class="plain">)));</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP9"></a><b>&#167;9. Angles. </b>We compute unit vectors in the D and E directions and then the squared
length of their difference. This is a fairly sharply increasing function of
the absolute value of the angular difference between D and E, and is such
that if the angles are equal then the result is zero; and it's cheap to
compute. So although it might seem nicer to calculate actual angles, this
is better.
</p>

<pre class="display">
    <span class="reserved">float</span><span class="plain"> </span><span class="functiontext">Geometry::vec_angular_separation<button class="popup" onclick="togglePopup('usagePopup187')">...<span class="popuptext" id="usagePopup187">Usage of <b>Geometry::vec_angular_separation</b>:<br>Spatial Map - <a href="3-sm2.html#SP21">&#167;21</a>, <a href="3-sm2.html#SP22">&#167;22</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">E</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">D</span><span class="plain">) {</span>
        <span class="reserved">float</span><span class="plain"> </span><span class="identifier">E_distance</span><span class="plain"> = </span><span class="functiontext"><a href="#SP8">Geometry::vec_length</a></span><span class="plain">(</span><span class="identifier">E</span><span class="plain">);</span>
        <span class="reserved">float</span><span class="plain"> </span><span class="identifier">uex</span><span class="plain"> = </span><span class="identifier">E</span><span class="plain">.</span><span class="element">x</span><span class="plain">/</span><span class="identifier">E_distance</span><span class="plain">, </span><span class="identifier">uey</span><span class="plain"> = </span><span class="identifier">E</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">/</span><span class="identifier">E_distance</span><span class="plain">, </span><span class="identifier">uez</span><span class="plain"> = </span><span class="identifier">E</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">/</span><span class="identifier">E_distance</span><span class="plain">;</span>
        <span class="reserved">float</span><span class="plain"> </span><span class="identifier">D_distance</span><span class="plain"> = </span><span class="functiontext"><a href="#SP8">Geometry::vec_length</a></span><span class="plain">(</span><span class="identifier">D</span><span class="plain">);</span>
        <span class="reserved">float</span><span class="plain"> </span><span class="identifier">udx</span><span class="plain"> = </span><span class="identifier">D</span><span class="plain">.</span><span class="element">x</span><span class="plain">/</span><span class="identifier">D_distance</span><span class="plain">, </span><span class="identifier">udy</span><span class="plain"> = </span><span class="identifier">D</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">/</span><span class="identifier">D_distance</span><span class="plain">, </span><span class="identifier">udz</span><span class="plain"> = </span><span class="identifier">D</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">/</span><span class="identifier">D_distance</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> (</span><span class="identifier">uex</span><span class="plain">-</span><span class="identifier">udx</span><span class="plain">)*(</span><span class="identifier">uex</span><span class="plain">-</span><span class="identifier">udx</span><span class="plain">) + (</span><span class="identifier">uey</span><span class="plain">-</span><span class="identifier">udy</span><span class="plain">)*(</span><span class="identifier">uey</span><span class="plain">-</span><span class="identifier">udy</span><span class="plain">) + (</span><span class="identifier">uez</span><span class="plain">-</span><span class="identifier">udz</span><span class="plain">)*(</span><span class="identifier">uez</span><span class="plain">-</span><span class="identifier">udz</span><span class="plain">);</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP10"></a><b>&#167;10. Cuboids. </b>To form a populated cuboid, first request an empty one, and then adjust it
for each vector to join the population.
</p>

<pre class="display">
    <span class="reserved">cuboid</span><span class="plain"> </span><span class="functiontext">Geometry::empty_cuboid<button class="popup" onclick="togglePopup('usagePopup188')">...<span class="popuptext" id="usagePopup188">Usage of <b>Geometry::empty_cuboid</b>:<br>Spatial Map - <a href="3-sm2.html#SP8">&#167;8</a>, <a href="3-sm2.html#SP12">&#167;12</a>, <a href="3-sm2.html#SP8_18">&#167;8.18</a>, <a href="3-sm2.html#SP19">&#167;19</a>, <a href="3-sm2.html#SP8_32">&#167;8.32</a>, <a href="3-sm2.html#SP8_34">&#167;8.34</a></span></button></span><span class="plain">(</span><span class="reserved">void</span><span class="plain">) {</span>
        <span class="reserved">cuboid</span><span class="plain"> </span><span class="identifier">C</span><span class="plain">;</span>
        <span class="identifier">C</span><span class="plain">.</span><span class="element">population</span><span class="plain"> = </span><span class="constant">0</span><span class="plain">;</span>
        <span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain"> = </span><span class="identifier">Zero_vector</span><span class="plain">; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain"> = </span><span class="identifier">Zero_vector</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">C</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">void</span><span class="plain"> </span><span class="functiontext">Geometry::adjust_cuboid<button class="popup" onclick="togglePopup('usagePopup189')">...<span class="popuptext" id="usagePopup189">Usage of <b>Geometry::adjust_cuboid</b>:<br><a href="#SP11">&#167;11</a>, Spatial Map - <a href="3-sm2.html#SP19">&#167;19</a>, <a href="3-sm2.html#SP8_34">&#167;8.34</a></span></button></span><span class="plain">(</span><span class="reserved">cuboid</span><span class="plain"> *</span><span class="identifier">C</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">population</span><span class="plain">++ == </span><span class="constant">0</span><span class="plain">) {</span>
            <span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">;</span>
        <span class="plain">} </span><span class="reserved">else</span><span class="plain"> {</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
        <span class="plain">}</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP11"></a><b>&#167;11.  </b>The following expands \(C\) minimally so that it contains \(X\).
</p>

<pre class="display">
    <span class="reserved">void</span><span class="plain"> </span><span class="functiontext">Geometry::merge_cuboid<button class="popup" onclick="togglePopup('usagePopup190')">...<span class="popuptext" id="usagePopup190">Usage of <b>Geometry::merge_cuboid</b>:<br>Spatial Map - <a href="3-sm2.html#SP8_32_1">&#167;8.32.1</a></span></button></span><span class="plain">(</span><span class="reserved">cuboid</span><span class="plain"> *</span><span class="identifier">C</span><span class="plain">, </span><span class="reserved">cuboid</span><span class="plain"> </span><span class="identifier">X</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">X</span><span class="plain">.</span><span class="element">population</span><span class="plain"> &gt; </span><span class="constant">0</span><span class="plain">) {</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">population</span><span class="plain"> == </span><span class="constant">0</span><span class="plain">) {</span>
                <span class="plain">*</span><span class="identifier">C</span><span class="plain"> = </span><span class="identifier">X</span><span class="plain">;</span>
            <span class="plain">} </span><span class="reserved">else</span><span class="plain"> {</span>
                <span class="functiontext"><a href="#SP10">Geometry::adjust_cuboid</a></span><span class="plain">(</span><span class="identifier">C</span><span class="plain">, </span><span class="identifier">X</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">);</span>
                <span class="functiontext"><a href="#SP10">Geometry::adjust_cuboid</a></span><span class="plain">(</span><span class="identifier">C</span><span class="plain">, </span><span class="identifier">X</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">);</span>
                <span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">population</span><span class="plain"> += </span><span class="identifier">X</span><span class="plain">.</span><span class="element">population</span><span class="plain"> - </span><span class="constant">2</span><span class="plain">;</span>
            <span class="plain">}</span>
        <span class="plain">}</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP12"></a><b>&#167;12.  </b>Here we shift an entire cuboid over (assuming all of the points inside
it have made the same shift).
</p>

<pre class="display">
    <span class="reserved">void</span><span class="plain"> </span><span class="functiontext">Geometry::cuboid_translate<button class="popup" onclick="togglePopup('usagePopup191')">...<span class="popuptext" id="usagePopup191">Usage of <b>Geometry::cuboid_translate</b>:<br>Spatial Map - <a href="3-sm2.html#SP8_21">&#167;8.21</a></span></button></span><span class="plain">(</span><span class="reserved">cuboid</span><span class="plain"> *</span><span class="identifier">C</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">D</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">population</span><span class="plain"> &gt; </span><span class="constant">0</span><span class="plain">) {</span>
            <span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain"> = </span><span class="functiontext"><a href="#SP7">Geometry::vec_plus</a></span><span class="plain">(</span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">, </span><span class="identifier">D</span><span class="plain">);</span>
            <span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain"> = </span><span class="functiontext"><a href="#SP7">Geometry::vec_plus</a></span><span class="plain">(</span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">, </span><span class="identifier">D</span><span class="plain">);</span>
        <span class="plain">}</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP13"></a><b>&#167;13.  </b></p>

<pre class="display">
    <span class="reserved">int</span><span class="plain"> </span><span class="functiontext">Geometry::within_cuboid<button class="popup" onclick="togglePopup('usagePopup192')">...<span class="popuptext" id="usagePopup192">Usage of <b>Geometry::within_cuboid</b>:<br><a href="#SP14">&#167;14</a>, Spatial Map - <a href="3-sm2.html#SP16">&#167;16</a><br>HTML Map - <a href="3-hm.html#SP2">&#167;2</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">P</span><span class="plain">, </span><span class="reserved">cuboid</span><span class="plain"> </span><span class="identifier">C</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">C</span><span class="plain">.</span><span class="element">population</span><span class="plain"> == </span><span class="constant">0</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">P</span><span class="plain">.</span><span class="element">x</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">P</span><span class="plain">.</span><span class="element">x</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">P</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">P</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">P</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">P</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="identifier">FALSE</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">TRUE</span><span class="plain">;</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP14"></a><b>&#167;14.  </b>Suppose we have a one-dimensional array whose entries correspond to the
integer grid positions within a cuboid (including its faces and corners).
The following returns \(-1\) if a point is outside the cuboid, or returns
the index if it is.
</p>

<pre class="display">
    <span class="reserved">int</span><span class="plain"> </span><span class="functiontext">Geometry::cuboid_index<button class="popup" onclick="togglePopup('usagePopup193')">...<span class="popuptext" id="usagePopup193">Usage of <b>Geometry::cuboid_index</b>:<br>Spatial Map - <a href="3-sm2.html#SP14">&#167;14</a>, <a href="3-sm2.html#SP16">&#167;16</a>, <a href="3-sm2.html#SP16_1">&#167;16.1</a><br>HTML Map - <a href="3-hm.html#SP1">&#167;1</a></span></button></span><span class="plain">(</span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">P</span><span class="plain">, </span><span class="reserved">cuboid</span><span class="plain"> </span><span class="identifier">C</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="functiontext"><a href="#SP13">Geometry::within_cuboid</a></span><span class="plain">(</span><span class="identifier">P</span><span class="plain">, </span><span class="identifier">C</span><span class="plain">) == </span><span class="identifier">FALSE</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> -1;</span>
        <span class="reserved">vector</span><span class="plain"> </span><span class="identifier">O</span><span class="plain"> = </span><span class="functiontext"><a href="#SP7">Geometry::vec_minus</a></span><span class="plain">(</span><span class="identifier">P</span><span class="plain">, </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">);</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">width</span><span class="plain">  = </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain"> - </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain"> + </span><span class="constant">1</span><span class="plain">;</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">height</span><span class="plain"> = </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> - </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> + </span><span class="constant">1</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">O</span><span class="plain">.</span><span class="element">x</span><span class="plain"> + </span><span class="identifier">O</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">*</span><span class="identifier">width</span><span class="plain"> + </span><span class="identifier">O</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">*</span><span class="identifier">width</span><span class="plain">*</span><span class="identifier">height</span><span class="plain">;</span>
    <span class="plain">}</span>

    <span class="reserved">int</span><span class="plain"> </span><span class="functiontext">Geometry::cuboid_volume<button class="popup" onclick="togglePopup('usagePopup194')">...<span class="popuptext" id="usagePopup194">Usage of <b>Geometry::cuboid_volume</b>:<br>Spatial Map - <a href="3-sm2.html#SP16_1">&#167;16.1</a><br>HTML Map - <a href="3-hm.html#SP1_1">&#167;1.1</a></span></button></span><span class="plain">(</span><span class="reserved">cuboid</span><span class="plain"> </span><span class="identifier">C</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">C</span><span class="plain">.</span><span class="element">population</span><span class="plain"> == </span><span class="constant">0</span><span class="plain">) </span><span class="reserved">return</span><span class="plain"> </span><span class="constant">0</span><span class="plain">;</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">width</span><span class="plain">  = </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain"> - </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain"> + </span><span class="constant">1</span><span class="plain">;</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">height</span><span class="plain"> = </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> - </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> + </span><span class="constant">1</span><span class="plain">;</span>
        <span class="reserved">int</span><span class="plain"> </span><span class="identifier">depth</span><span class="plain">  = </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> - </span><span class="identifier">C</span><span class="plain">.</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> + </span><span class="constant">1</span><span class="plain">;</span>
        <span class="reserved">return</span><span class="plain"> </span><span class="identifier">width</span><span class="plain">*</span><span class="identifier">height</span><span class="plain">*</span><span class="identifier">depth</span><span class="plain">;</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<p class="inwebparagraph"><a id="SP15"></a><b>&#167;15.  </b>Thickening a cuboid is a little more than adjusting; we give it some
extra room. (The result is thus no longer minimally bounding, but we
sacrifice that.)
</p>

<pre class="display">
    <span class="reserved">void</span><span class="plain"> </span><span class="functiontext">Geometry::thicken_cuboid<button class="popup" onclick="togglePopup('usagePopup195')">...<span class="popuptext" id="usagePopup195">Usage of <b>Geometry::thicken_cuboid</b>:<br>Spatial Map - <a href="3-sm2.html#SP16_1">&#167;16.1</a></span></button></span><span class="plain">(</span><span class="reserved">cuboid</span><span class="plain"> *</span><span class="identifier">C</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">V</span><span class="plain">, </span><span class="reserved">vector</span><span class="plain"> </span><span class="identifier">S</span><span class="plain">) {</span>
        <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">population</span><span class="plain">++ == </span><span class="constant">0</span><span class="plain">) {</span>
            <span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain"> = </span><span class="functiontext"><a href="#SP7">Geometry::vec_minus</a></span><span class="plain">(</span><span class="identifier">V</span><span class="plain">, </span><span class="identifier">S</span><span class="plain">);</span>
            <span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain"> = </span><span class="functiontext"><a href="#SP7">Geometry::vec_plus</a></span><span class="plain">(</span><span class="identifier">V</span><span class="plain">, </span><span class="identifier">S</span><span class="plain">);</span>
        <span class="plain">} </span><span class="reserved">else</span><span class="plain"> {</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> - </span><span class="identifier">S</span><span class="plain">.</span><span class="element">x</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="element">x</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="element">x</span><span class="plain"> + </span><span class="identifier">S</span><span class="plain">.</span><span class="element">x</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> - </span><span class="identifier">S</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">y</span><span class="plain"> + </span><span class="identifier">S</span><span class="plain">.</span><span class="identifier">y</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> &lt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner0</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> - </span><span class="identifier">S</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
            <span class="reserved">if</span><span class="plain"> (</span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> &gt; </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">) </span><span class="identifier">C</span><span class="plain">-&gt;</span><span class="element">corner1</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> = </span><span class="identifier">V</span><span class="plain">.</span><span class="identifier">z</span><span class="plain"> + </span><span class="identifier">S</span><span class="plain">.</span><span class="identifier">z</span><span class="plain">;</span>
        <span class="plain">}</span>
    <span class="plain">}</span>
</pre>

<p class="inwebparagraph"></p>

<hr class="tocbar">
<ul class="toc"><li><a href="3-mcr.html">Back to 'Map Connection Relations'</a></li><li><a href="3-sm2.html">Continue with 'Spatial Map'</a></li></ul><hr class="tocbar">
<!--End of weave-->
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
MathJax = {
  tex: {
    inlineMath: '$', '$'], ['\\(', '\\)'
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

		</main>
	</body>
</html>

